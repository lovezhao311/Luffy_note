# MySQL建表规范与常见问题
-------
### 1. 表设计
 - 库名、表名、字段名必须使用小写字母，“_”分割。
 - 库名、表名、字段名必须不超过12个字符。
 - 库名、表名、字段名见名知意,建议使用名词而不是动词。
 - 存储精确浮点数必须使用DECIMAL替代FLOAT和DOUBLE。
 - 建议使用UNSIGNED存储非负数值。
 - 建议使用INT UNSIGNED存储IPV4。
 - 整形定义中不添加长度，比如使用INT，而不是INT(4)。
 - 使用短数据类型，比如取值范围为0-80时，使用TINYINT UNSIGNED。
 - 不建议使用ENUM类型，使用TINYINT来代替。
 - 尽可能不使用TEXT、BLOB类型。
 - VARCHAR(N)，N表示的是字符数不是字节数，比如VARCHAR(255)，可以最大可存储255个汉字，需要根据实际的宽度来选择N。
 - VARCHAR(N)，N尽可能小，因为MySQL一个表中所有的VARCHAR字段最大长度是65535个字节，进行排序和创建临时表一类的内存操作时，会使用N的长度申请内存。表字符集选择UTF8。
 - 使用VARBINARY存储变长字符串。
 - 存储年使用YEAR类型。
 - 存储日期使用DATE类型。
 - 存储时间（精确到秒）建议使用TIMESTAMP类型，因为TIMESTAMP使用4字节，
 - DATETIME使用8个字节。
 - 建议字段定义为NOT NULL。
 - 将过大字段拆分到其他表中。
 - 禁止在数据库中使用VARBINARY、BLOB存储图片、文件等。
 - 建议使用InnoDB存储引擎。

### 2. 索引
 - 非唯一索引必须按照“idx_字段名称字段名称[字段名]”进行命。
 - 唯一索引必须按照“uniq_字段名称字段名称[字段名]”进行命名。
 - 索引名称必须使用小写。
 - 索引中的字段数建议不超过5个。
 - 单张表的索引数量控制在5个以内。
 - 唯一键由3个以下字段组成，并且字段都是整形时，使用唯一键作为主键。
 - 没有唯一键或者唯一键不符合5中的条件时，使用自增（或者通过发号器获取）id作为主键。
 - 索引字段的顺序需要考虑字段值去重之后的个数，个数多的放在前面
 - ORDER BY，GROUP BY，DISTINCT的字段需要添加在索引的后面
 - 使用EXPLAIN判断SQL语句是否合理使用索引，尽量避免extra列出现：Using File Sort，UsingTemporary。
 - UPDATE、DELETE语句需要根据WHERE条件添加索引
 - 合理创建联合索引（避免冗余），(a,b,c) 相当于 (a) 、(a,b) 、(a,b,c)。
 - 合理利用覆盖索引。

### 3.SQL语句
 - SQL语句中IN包含的值不应过多
 - UPDATE、DELETE语句不使用LIMIT。
 - SELECT语句只获取需要的字段。
 - 不建议使用%前缀模糊查询，例如LIKE “%weibo”。
 - 对长度过长的VARCHAR字段建立索引时，添加crc32或者MD5 Hash字段，对Hash字段建立索引。
 - WHERE条件中的非等值条件（IN、BETWEEN、<、<=、>、>=）会导致后面的条件使用不了索引。
 - 不使用ORDER BY RAND()，使用其他方法替换。
 - 建议使用合理的分页方式以提高分页的效率。
 - 统计表中记录数时使用COUNT(*)，而不是COUNT(primary_key)和COUNT(1)。
